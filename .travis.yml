# travis

language: generic
sudo: false
dist: trusty

before_install:
  - bash --version
  - openssl version

script:
  - |
      bash --posix ./create-root-ca -d travis-ca <<EOF
      travis-ca
      bogus.com
      US
      California
      San Francisco
      Bogus Inc.
      Operations
      Bogus Inc. Certificate Authority
      rootCA_password
      rootCA_password
      EOF
  - cd travis-ca/
  - |
      bash --posix ./bin/create-server -s travis-server.bogus.com -a www.travis-server.bogus.com << EOF
      rootCA_password
      US
      California
      San Francisco
      Bogus Inc.
      Jurisdiction of travis-server.bogus-com
      travis-server.bogus.com
      EOF
  - |
      bash --posix ./bin/create-client -c travis-client << EOF
      rootCA_password
      US
      California
      San Francisco
      Bogus Inc.
      private
      travis-client
      travis-client@bogus.com
      EOF
  - |
      bash --posix ./bin/revoke-cert -c certs/travis-server-bogus-com.server.crt << EOF
      1
      y
      rootCA_password
      EOF
  - |
      bash --posix ./bin/create-signing-ca -d travis-signing << EOF
      rootCA_password
      travis-signing
      bogus.com
      US
      California
      San Francisco
      Bogus Inc.
      Operations
      Bogus Inc. Certificate travis-signing
      signCA_password
      signCA_password
      EOF
  - bash --posix ./bin/show-status
  - bash --posix ./bin/gen-html
  - cd travis-signing/
  - |
      bash --posix ./bin/create-server -s travis-server.bogus.com -a www.travis-server.bogus.com << EOF
      signCA_password
      US
      California
      San Francisco
      Bogus Inc.
      Jurisdiction of travis-server.bogus-com
      travis-server.bogus.com
      EOF
  - |
      bash --posix ./bin/create-client -c travis-client << EOF
      signCA_password
      US
      California
      San Francisco
      Bogus Inc.
      private
      travis-client
      travis-client@bogus.com
      EOF
  - |
      bash --posix ./bin/revoke-cert -c certs/travis-server-bogus-com.server.crt << EOF
      1
      y
      signCA_password
      EOF
  - |
      bash --posix ./bin/revoke-cert -c certs/travis-client.client.crt << EOF
      5
      y
      signCA_password
      EOF
  - bash --posix ./bin/show-status
  - bash --posix ./bin/gen-html
